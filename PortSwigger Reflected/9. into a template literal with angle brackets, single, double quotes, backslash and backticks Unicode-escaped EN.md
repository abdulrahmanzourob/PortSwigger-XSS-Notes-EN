## 1ï¸âƒ£ General Information

|Element|Details|
|---|---|
|**Lab Link**|[HTML context with all standard tags blocked](https://portswigger.net/web-security/cross-site-scripting/contexts/lab-html-context-with-all-standard-tags-blocked)|
|**Solution Date**|2 / 5 / 2025|
|**Vulnerability Type**|Reflected Cross-Site Scripting (XSS)|

---

## 2ï¸âƒ£ Lab Description ğŸ§ª

This lab contains a **Reflected XSS vulnerability** within the **blog search function**.

![[image 2.png]]

When you type any word in the search box, it is displayed on the results page. But the result is displayed using a **JavaScript Template Literal**, with a set of filters applied to characters.

---

## 3ï¸âƒ£ Applied Filters ğŸ›¡ï¸

Some sensitive characters are automatically encoded (HTML encoded) to protect the page, such as:

- `<` and `>` â†’ become `\u003c` and `\u003e`
- `'` and `"` â†’ become `\u0027` and `\u0022`
- `` ` `` (Backtick) â†’ is encoded or blocked

ğŸ“Œ **But:** The expression `${}` inside the Template Literal **is not filtered**, and this is our entry point for the attack.

---

## 4ï¸âƒ£ Lab Scenario Analysis ğŸ”

When a search is performed, the search value is passed to the `message` variable in JavaScript like this:

```js
var message = `0 search results for 'z3rob \u003c \u0027 \u0022'`;
document.getElementById('searchMessage').innerText = message;
```

ğŸ”¸ This means that **the value entered by the user is injected inside a JavaScript Template Literal**, but with some characters encoded.

---

## 5ï¸âƒ£ What is a Template Literal? âœ…

### ğŸ“Œ Definition:

It's a new way in JavaScript to write strings more flexibly. **Backticks** are used instead of traditional quotes.

### ğŸ“Œ General Form:

```js
const name = "Ali";
const msg = `Hello, ${name}!`;
```

ğŸŸ¢ `${name}` is automatically replaced with the variable's value when the code runs.

### âœ¨ Features:

- Supports **variable interpolation** using `${}`
- Supports **multi-line strings** without needing `\n`
- Allows **expressions inside the string**

---

## 6ï¸âƒ£ Practical Examples of Template Literals ğŸ”§

### ğŸ”¹ Variable Interpolation:

```js
const user = "Sara";
console.log(`Welcome, ${user}!`); // Welcome, Sara!
```

### ğŸ”¹ Doing calculations inside the string:

```js
console.log(`5 + 3 = ${5 + 3}`); // 5 + 3 = 8
```

### ğŸ”¹ Multi-line strings:

```js
const paragraph = `Line 1
Line 2
Line 3`;
console.log(paragraph);
```

---

## 7ï¸âƒ£ Exploit Idea ğŸ’¥

Since the `${}` expression is not filtered inside the Template Literal, we can exploit this to execute code:

```js
${alert(0)}
```

So the final code when displaying the result will look like this:

```js
var message = `0 search results for '${alert(0)}'`;
document.getElementById('searchMessage').innerText = message;
```

ğŸ¯ This will execute the `alert(0)` function successfully, thus exploiting the vulnerability.

ğŸ“¸ Screenshot showing the attack in action:
![[image-1 2.png]]

---

## âœ… Summary:

- A simple but important lab because it teaches you how to exploit `${}` inside **Template Literals**.
- Normal characters are protected, but JavaScript expressions inside `${}` remain dangerous if not filtered.
- This type of exploitation shows the importance of knowing the context where input is reflected (HTML? JavaScript? Attribute?). 